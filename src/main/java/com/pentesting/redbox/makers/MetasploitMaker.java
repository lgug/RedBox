package com.pentesting.redbox.makers;

import com.pentesting.redbox.persistence.entities.Command;
import com.pentesting.redbox.utils.FileManager;

import java.io.IOException;
import java.nio.file.Path;
import java.util.Arrays;
import java.util.List;

public class MetasploitMaker implements Maker {

    @Override
    public Command makeTheRightCommand(Command command) {
        String commands = command.getParameters().get(command.getParameters().indexOf("-x") + 1);
        try {
            List<String> lines = Arrays.asList(commands.split(";"));
            lines.add(0,"db_rebuild_cache");
            Path path = FileManager.createFile(lines, "metasploit_file");
             return new Command("msfconsole", Arrays.asList("-q", "-r", path.toString()));
        } catch (IOException e) {
            e.printStackTrace();
            return null;
        }
    }

}
