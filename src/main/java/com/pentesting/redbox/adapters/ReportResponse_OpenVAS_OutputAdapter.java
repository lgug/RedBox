package com.pentesting.redbox.adapters;

import com.pentesting.redbox.beans.TaskResult;
import com.pentesting.redbox.beans.Vulnerability;
import com.pentesting.redbox.beans.enums.OpenVASReportStatus;

public class ReportResponse_OpenVAS_OutputAdapter extends OpenVAS_OutputAdapter {

    private String reportId;
    private OpenVASReportStatus reportStatus;
    private Integer runningStatus;
    private TaskResult taskResult;

    public ReportResponse_OpenVAS_OutputAdapter() {
    }

    public ReportResponse_OpenVAS_OutputAdapter(String reportId, OpenVASReportStatus reportStatus, Integer runningStatus, TaskResult taskResult) {
        this.reportId = reportId;
        this.reportStatus = reportStatus;
        this.runningStatus = runningStatus;
        this.taskResult = taskResult;
    }

    public String getReportId() {
        return reportId;
    }

    public void setReportId(String reportId) {
        this.reportId = reportId;
    }

    public OpenVASReportStatus getReportStatus() {
        return reportStatus;
    }

    public void setReportStatus(OpenVASReportStatus reportStatus) {
        this.reportStatus = reportStatus;
    }

    public Integer getRunningStatus() {
        return runningStatus;
    }

    public void setRunningStatus(Integer runningStatus) {
        this.runningStatus = runningStatus;
    }

    public TaskResult getTaskResult() {
        return taskResult;
    }

    public void setTaskResult(TaskResult taskResult) {
        this.taskResult = taskResult;
    }

    public void calculateThreatTypesNumber() {
        Integer log = 0;
        Integer low = 0;
        Integer medium = 0;
        Integer high = 0;
        for (Vulnerability vulnerability: taskResult.getVulnerabilityList()) {
            if (vulnerability.getThreatLevel().matches("Log.*")) log++;
            else if (vulnerability.getThreatLevel().matches("Low.*")) low++;
            else if (vulnerability.getThreatLevel().matches("Medium.*")) medium++;
            else if (vulnerability.getThreatLevel().matches("High.*")) high++;
        }
        this.taskResult.setLogNumber(log);
        this.taskResult.setLowNumber(low);
        this.taskResult.setMediumNumber(medium);
        this.taskResult.setHighNumber(high);
    }

}
